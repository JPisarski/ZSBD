-- zadanie I

DROP TABLE DEPARTMENTS;
DROP TABLE EMPLOYEES;
DROP TABLE JOB_HISTORY;
DROP TABLE JOBS;
DROP TABLE LOCATIONS;
DROP TABLE COUNTRIES;
DROP TABLE REGIONS;

-- zadanie II

CREATE TABLE DEPARTMENTS AS SELECT * FROM HR.DEPARTMENTS;
CREATE TABLE EMPLOYEES AS SELECT * FROM HR.EMPLOYEES;
CREATE TABLE JOB_HISTORY AS SELECT * FROM HR.JOB_HISTORY;
CREATE TABLE JOBS AS SELECT * FROM HR.JOBS;
CREATE TABLE LOCATIONS AS SELECT * FROM HR.LOCATIONS;
CREATE TABLE COUNTRIES AS SELECT * FROM HR.COUNTRIES;
CREATE TABLE REGIONS AS SELECT * FROM HR.REGIONS;
ALTER TABLE REGIONS ADD PRIMARY KEY(region_id);
ALTER TABLE COUNTRIES ADD PRIMARY KEY(country_id);
ALTER TABLE LOCATIONS ADD PRIMARY KEY(location_id);
ALTER TABLE JOBS ADD PRIMARY KEY(job_id); 
ALTER TABLE DEPARTMENTS ADD PRIMARY KEY(department_id);
ALTER TABLE EMPLOYEES ADD PRIMARY KEY(employee_id); 
ALTER TABLE JOB_HISTORY ADD CONSTRAINT PK_JOB_HISTORY PRIMARY KEY (employee_id, start_date);
ALTER TABLE COUNTRIES ADD FOREIGN KEY(region_id) REFERENCES REGIONS(region_id);
ALTER TABLE LOCATIONS ADD FOREIGN KEY(country_id) REFERENCES COUNTRIES(country_id);
ALTER TABLE DEPARTMENTS ADD FOREIGN KEY(manager_id) REFERENCES EMPLOYEES(employee_id);
ALTER TABLE DEPARTMENTS ADD FOREIGN KEY(location_id) REFERENCES LOCATIONS(location_id);
ALTER TABLE EMPLOYEES ADD FOREIGN KEY(job_id) REFERENCES JOBS(job_id);
ALTER TABLE EMPLOYEES ADD FOREIGN KEY(department_id) REFERENCES DEPARTMENTS(department_id);
ALTER TABLE EMPLOYEES ADD FOREIGN KEY(manager_id) REFERENCES EMPLOYEES(employee_id);
ALTER TABLE JOB_HISTORY ADD FOREIGN KEY(employee_id) REFERENCES EMPLOYEES(employee_id);
ALTER TABLE JOB_HISTORY ADD FOREIGN KEY(job_id) REFERENCES JOBS(job_id);

-- zadanie III

--  zadanie 1

SELECT LAST_NAME || ' ' || SALARY AS WYNAGRODZENIE FROM EMPLOYEES WHERE DEPARTMENT_ID IN(20, 50) AND SALARY BETWEEN 2000 AND 7000 ORDER BY LAST_NAME;

-- zadanie 2

SELECT employees.hire_date, employees.last_name, employees.salary FROM employees JOIN employees on employees.manager_id = employees.employee_id WHERE EXTRACT(YEAR FROM employees.hire_date) = 2005;

--  zadanie 3

--  zadanie 4

--  zadanie 5

--  zadanie 6

--  zadanie 7

--  zadanie 8

--  zadanie 9

--  zadanie 10

--  zadanie 11

--  zadanie 12

--  zadanie 13

--  zadanie 14

--  zadanie 15

--  zadanie 16

--  zadanie 17

--  zadanie 18

--  zadanie 19

--  zadanie 20
